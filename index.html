<!DOCTYPE html>

<html lang="en">
<head>
<!-- Standard favicon -->
<link href="favicon.png" rel="icon" sizes="32x32" type="image/png"/>
<link href="favicon.png" rel="shortcut icon"/>
<link href="favicon.png" rel="apple-touch-icon" sizes="180x180"/>
<meta content="favicon.png" name="msapplication-TileImage"/>
<meta content="DDUilCrWn1kQduzzu9YyZkAd_XnpA-aPrHKeuartGRo" name="google-site-verification">
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, minimum-scale=0.8, maximum-scale=0.8, user-scalable=no" name="viewport"/>
<meta content="index, follow" name="robots"/>
<title>QR Code Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&amp;display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
<style>
    :root{
      --glass: rgba(255,255,255,0.06);
      --accent: #7b61ff;
      --control-bg: rgba(255,255,255,0.15);
      /* global scale factors */
      --scale: 1;
      --topbar-height: 64px;
    }
    *{box-sizing:border-box}
    html, body { font-size: 16px; scroll-behavior:smooth; scroll-padding-top: var(--topbar-height); -webkit-text-size-adjust:100%; }
    body{
      margin:0;
      min-height:100vh;
      font-family:'Poppins',system-ui,Segoe UI,Roboto,Arial;
      /* restored colorful gradient background */
      background: linear-gradient(120deg,#FF8A00 0%, #FF3D81 30%, #7B61FF 60%, #00D2FF 100%);
      display:block;
      /* ensure content is below fixed topbar */
      padding: calc(var(--topbar-height) + 16px) 20px 20px;
      color:#000;
      overflow:auto;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      font-size: calc(1rem * var(--scale));
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      touch-action: manipulation;
    }

    /* Layout */
    .container{
      position:relative;
      z-index:2;
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: clamp(12px, 3vw, 32px);
      align-items: stretch;
      max-width:1200px;
      width:100%;
      margin: 0.2mm auto 0;
      padding: 0 16px;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
      backdrop-filter: blur(6px);
      border-radius: clamp(10px, 1.6vw, 22px);
      padding: clamp(12px, 2.2vw, 24px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.18);
      overflow:visible;
      display:flex;
      flex-direction:column;
      justify-content:flex-start;
      transition: box-shadow 300ms ease, transform 300ms ease;
      min-height: 240px;
    }

    .card.left { min-width: 260px; }
    @media (max-width:420px) { .card.left { min-width: auto; } }

    .controls { gap: clamp(8px, 2vw, 14px); }

    .preview{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      padding: clamp(12px, 2.2vw, 20px);
      min-height: 240px;
    }

    /* QR holder/frame */
    #qr-holder {
      display:flex;
      align-items:center;
      justify-content:center;
      margin: 8px 0;
      width: 100%;
      min-height: 360px;
    }

    .qr-frame{
      width: clamp(200px, 44vw, 420px);
      height: clamp(200px, 44vw, 420px);
      max-width: 420px;
      max-height: 420px;
      display:flex;
      align-items:center;
      justify-content:center;
      background: rgba(255,255,255,0.12);
      border-radius: clamp(10px, 1.2vw, 18px);
      padding: 12px;
      box-shadow: 0 8px 18px rgba(0,0,0,0.12);
      transition: box-shadow 220ms ease, transform 220ms cubic-bezier(.2,.9,.2,1);
      flex: 0 0 auto;
      will-change: transform, box-shadow;
      max-width:100%;
    }

    /* Keep QR preview stable (no grow) */
    .qr-frame:hover,
    .qr-frame:focus-within {
      transform: none;
      box-shadow: 0 8px 18px rgba(0,0,0,0.12);
      z-index: 1;
    }

    .qr-inner{
      display:flex;
      align-items:center;
      justify-content:center;
      background: transparent;
      border-radius: 8px;
      flex: 0 0 auto;
    }

    .qr-inner canvas, .qr-inner svg, .qr-inner img {
      display:block;
      width:100% !important;
      height:100% !important;
      object-fit:contain;
      border-radius: 6px;
    }

    .meta {
      margin-top: 10px;
      display:flex;
      flex-direction:column;
      gap:10px;
      align-items:center;
      font-size:15px;
      color:#000;
      text-shadow:0 0 6px rgba(0,0,0,0.03);
      flex: 0 0 auto;
    }

    /* keep form/control text readable */
    input[type=range], input[type=color], select, textarea, input[type=text], input[type=file] {
      font-size: 15px;
      padding: clamp(8px, 1.4vw, 10px);
      border-radius:8px;
      border:0;
      background: var(--control-bg);
      outline: none;
      transition: transform 260ms cubic-bezier(.2,.9,.2,1), box-shadow 260ms ease;
      will-change: transform, box-shadow;
    }

    @media (max-width:420px){
      body { padding: calc(var(--topbar-height) + 8px) 12px 16px; }
      .container { margin-top:0.2mm; gap:12px; padding:0 8px; }
      .topbar h2 { font-size: 1.05rem; }
      .menu-btn { font-size: 22px; padding:8px 10px; }
      .qr-frame { width: clamp(160px, 48vw, 360px); height: clamp(160px, 48vw, 360px); }
      #qr-holder { min-height: 260px; }
      input, select, textarea { font-size:16px; padding:12px; }
      .btn { padding:12px 18px; }
      .cookie-banner { left:12px; right:12px; bottom: calc(12px + env(safe-area-inset-bottom)); }
    }

    @media (min-width:1400px){
      .container { max-width:1400px; gap:40px; }
      .card { padding: clamp(18px, 1.8vw, 28px); }
    }

    .controls{display:grid;gap:10px;margin-bottom:10px}

    /* .field still provides a subtle background but NO hover-grow on the container */
    .field{
      background:var(--glass);
      padding:10px;
      border-radius:10px;
      transition: box-shadow 200ms ease; /* keep gentle shadow change only if needed */
      will-change: box-shadow;
      transform-origin: center;
    }

    /* NOTE: removed .field:hover/.field:focus-within growth so child control hover won't scale the whole box */

    /* The QR Style selector you liked */
    #effect{
      transition: transform 260ms cubic-bezier(.2,.9,.2,1), box-shadow 260ms ease;
      will-change: transform, box-shadow;
      border-radius:8px;
      padding:10px;
      background: var(--control-bg);
      cursor:pointer;
    }
    #effect:hover,
    #effect:focus {
      transform: translateY(-3px) scale(1.015);
      box-shadow: 0 10px 24px rgba(0,0,0,0.22);
      outline: none;
    }

    /* Apply same subtle effect to other controls requested */
    #type,               /* Type select */
    #content,            /* content textarea */
    #sizeRange,          /* range slider */
    .color-input,        /* color pickers */
    #logo-file           /* file input */
    {
      transition: transform 260ms cubic-bezier(.2,.9,.2,1), box-shadow 260ms ease, background 160ms ease;
      will-change: transform, box-shadow;
      border-radius:8px;
      background: var(--control-bg);
    }

    /* Hover/focus for those controls (small grow like QR style) */
    #type:hover, #type:focus,
    #content:hover, #content:focus,
    #sizeRange:hover, #sizeRange:focus,
    .color-input:hover, .color-input:focus,
    #logo-file:hover, #logo-file:focus
    {
      transform: translateY(-3px) scale(1.015);
      box-shadow: 0 10px 24px rgba(0,0,0,0.22);
      outline: none;
    }

    /* For range specifically, keep the blue thumb/track appearance intact but let the control grow */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      height: 6px;
      background: transparent;
      touch-action: pan-x;
    }
    input[type="range"]::-webkit-slider-runnable-track {
      height: 6px;
      background: linear-gradient(90deg,#4aa3ff,#3b82f6);
      border-radius: 6px;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width:16px;height:16px;border-radius:50%;
      background:#fff;border:3px solid #1f6feb;margin-top:-5px;
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
    }
    input[type="range"]::-moz-range-track {
      height:6px;background: linear-gradient(90deg,#4aa3ff,#3b82f6);border-radius:6px;
    }
    input[type="range"]::-moz-range-thumb {
      width:16px;height:16px;border-radius:50%; background:#fff;border:3px solid #1f6feb;
      box-shadow:0 2px 6px rgba(0,0,0,0.2);
    }

    label{display:block;font-size:15px;margin-bottom:6px;opacity:0.95;color:#000;text-shadow:0 0 6px rgba(0,0,0,0.03) }

    input[type=text], select, textarea{
      width:100%;
      padding:10px;
      border-radius:8px;
      border:0;
      background:var(--control-bg);
      color:#000;
      font-size:15px;
      outline:none;
      transition:all 0.20s ease;
      text-shadow:0 0 6px rgba(0,0,0,0.02)
    }
    textarea{min-height:72px;resize:none}
    .row{display:flex;gap:10px;flex-wrap:wrap}

    .btn{
      background:linear-gradient(90deg,#ff8a00,#ff3d81,#7b61ff,#00d2ff);
      border:0;padding:10px 16px;border-radius:10px;
      color:#000;font-weight:600;cursor:pointer;font-size:15px;
      transition:0.22s;
      text-shadow:0 0 6px rgba(0,0,0,0.12)
    }
    .btn:hover{opacity:0.94}
    .btn:active{transform:scale(0.985)}

    .color-input{height:28px;width:44px;border-radius:6px;border:0;padding:0}
    .range{display:flex;align-items:center;gap:10px}
    input[type=range]{width:100%;transition:all 0.16s ease}

    @keyframes pulse {0%{transform:scale(1);}50%{transform:scale(0.9);}100%{transform:scale(1);} }

    @media (max-width:900px){
      body{display:block;overflow:auto;}
      .preview{order:-1}
      .left h1, .left p { display:none; }
    }

    /* Top bar & side menu */
    .topbar {
      position:fixed; top:0; left:0; right:0; height:var(--topbar-height);
      background:rgba(255,255,255,0.4); backdrop-filter:blur(8px);
      color:#fff; display:flex; align-items:center; justify-content:space-between;
      padding:0 16px; z-index:10000;
    }
    .menu-btn { background:none; border:none; color:#fff; font-size:22px; cursor:pointer; padding:8px; border-radius:8px; }
    .side-menu {
      position:fixed; top:0; left:0;
      width:80vw;
      max-width:320px;
      height:100%;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:stretch;
      background:rgba(255,255,255,0.24); backdrop-filter:blur(10px);
      padding:20px;
      transform:translateX(-110%);
      transition:transform 320ms cubic-bezier(.2,.9,.2,1);
      z-index:9999;
      box-shadow: 10px 0 40px rgba(0,0,0,0.18);
    }
    .side-menu.show { transform:translateX(0); }

    .side-menu a {
      display:block; width:100%; color:#fff; text-decoration:none; margin:8px 0;
      padding:12px 14px; border-radius:8px; font-weight:700; background:transparent; box-sizing:border-box;
      transition: background 220ms ease;
      will-change: background;
      font-size:1.05rem;
      line-height:1.1;
    }
    .side-menu a:hover { background: rgba(255, 255, 255, 0.10); }
    .side-menu a.active { background: transparent; }

    .info-section {
      max-width:1000px;
      margin:12px auto 90px;
      padding:8px;
      border-radius:10px;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
      backdrop-filter: blur(6px);
      color:#000;
      position: relative;
      min-height: 60px;
      overflow: visible;
      scroll-behavior: smooth;
    }

    .info-section > .info-item {
      display:block;
      position:relative;
      padding: 4px 8px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(2px);
      will-change: transform, opacity, max-height;
      transition: transform 320ms cubic-bezier(.2,.9,.2,1), opacity 280ms ease, max-height 360ms ease;
      overflow: hidden;
      max-height: 0;
      margin: 0;
    }

    .info-section > .info-item.active {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
      max-height: 1600px;
    }

    .info-section .info-item h2 {
      margin: 0 0 6px 0;
      font-size: 1.12rem;
      line-height:1.12;
    }
    .info-section .info-item p {
      margin: 0 0 8px 0;
      line-height: 1.5;
      font-size: 15px;
    }
    .info-section .info-item ul { margin: 0 0 8px 18px; padding:0; }
    .info-section article { margin: 0 0 8px 0; padding:0; }
    .info-section .info-item li { margin: 0 0 6px 0; padding:0; line-height:1.38; font-size:15px; }

    .cookie-banner {
      position:fixed; left:16px; right:16px; bottom:16px; z-index:100000; display:flex; gap:12px; align-items:center; padding:12px; border-radius:12px; background:rgba(255,255,255,0.96); box-shadow:0 10px 30px rgba(0,0,0,0.12);
    }
    .cookie-banner p{ margin:0; font-size:14px; color:#111 }
    .cookie-banner a{ color:var(--accent); font-weight:700; text-decoration:none }

    #cropperModal { position: fixed; top:0; left:0; width:100%; height:100%; display:none; align-items:center; justify-content:center; z-index:99999; gap:0; }
    #cropperModal.show { display:flex; pointer-events:auto; }
    #cropperModal .backdrop { position:absolute; inset:0; background:rgba(0,0,0,0.6); opacity:0; transform:scale(.998); transition:all 160ms ease; pointer-events:auto; }
    #cropperBox { position:relative; background:#fff; padding:14px; border-radius:12px; max-width:92%; max-height:92%; display:flex; flex-direction:column; align-items:center; z-index:2; transform:translateY(6px) scale(.99); opacity:0; transition:all 180ms cubic-bezier(.2,.9,.2,1); box-shadow:0 20px 60px rgba(0,0,0,0.4); overflow:auto; pointer-events:auto; }
    #cropperModal.show #cropperBox { transform:translateY(0) scale(1); opacity:1; }
    #cropperImage { max-width:100%; max-height:65vh; display:block; border-radius:8px; }

    [id] { scroll-margin-top:0.25mm; }

    /* when menu open, prevent body scroll */
    .menu-open { overflow: hidden; touch-action: none; }

    /* small utility for safe tap targets */
    button, a[role="button"] { -webkit-tap-highlight-color: transparent; }
  
/* Make the color preview area bigger and clearer */
.color-preview {
  width: 100px;
  height: 100px;
  border: 3px solid #fff;
  border-radius: 12px;
  margin: 15px auto;
}

/* Nicely sized smaller color input boxes */
input[type="color"] {
  width: 30px;
  height: 30px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  padding: 0;
}
</style>
</link></link></meta>    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7183827699743444" crossorigin="anonymous"></script>
    <script type='text/javascript' src='//pl27682940.revenuecpmgate.com/fb/5c/8f/fb5c8f524df9c4d5095456ada43ba7e1.js'></script>
</head>
<body>
<!-- Top Bar -->
<div class="topbar">
<button aria-controls="sideMenu" aria-expanded="false" class="menu-btn" onclick="toggleMenu()">☰ Menu</button>
<h2 style="margin:0;font-size:1.12rem">QR Code Generator Seven Deab</h2>
</div>
<!-- Side Menu -->
<nav aria-hidden="true" class="side-menu" id="sideMenu" role="navigation">
<div class="spacer"></div>
<a data-target="home" href="#home">Home</a>
<a data-target="about" href="#about">About</a>
<a data-target="how" href="#how">How it Works</a>
<a data-target="articles" href="#articles">Articles</a>
<a data-target="privacy" href="#privacy">Privacy Policy</a>
<a data-target="terms" href="#terms">Terms</a>
<a data-target="contact" href="#contact">Contacts</a>
</nav>
<!-- Main QR Generator -->
<main aria-label="QR generator main area" class="container" id="home" role="main">
<!-- Left Side -->
<div class="card left">
<div class="controls">
<div class="field">
<label for="type"><h3 style="margin:0;font-size:1.05rem">Type</h3></label>
<select id="type">
<option value="text">Plain Text</option>
<option value="url">URL</option>
</select>
</div>
</div>
<div class="field" id="content-field">
<label id="content-label" style="display:block;margin-bottom:6px">Content</label>
<textarea id="content" placeholder="Paste your text..."></textarea>
</div>
<div class="row" style="margin-top:8px">
<div class="field" style="flex:1">
<label style="display:block;margin-bottom:6px"><h3 style="margin:0;font-size:1.02rem">Logo / Center Image (optional)</h3></label>
<input accept="image/*" id="logo-file" type="file"/>
</div>
<div class="field" style="width:220px">
<label style="display:block;margin-bottom:6px">Size (Max 320px)</label>
<div class="range">
<input id="sizeRange" max="320" min="128" type="range" value="320"/>
<div id="sizeVal" style="width:50px;text-align:right;font-size:15px">320px</div>
</div>
</div>
</div>
<div class="row" style="margin-top:8px">
<div class="field" style="flex:1">
<label style="display:block;margin-bottom:6px">Foreground Color</label>
<input class="color-input" id="fg" type="color" value="#000000"/>
</div>
<div class="field" style="flex:1">
<label style="display:block;margin-bottom:6px">Background Color</label>
<input class="color-input" id="bg" type="color" value="#ffffff"/>
</div>
</div>
<div style="margin-top:10px">
<button class="btn" id="downloadPNG">Download PNG</button>
<div id="ad-placeholder" style="margin-top:8px;font-size:14px;color:#222;opacity:0.9">Ad unit: hidden until AdSense approved</div>
</div>
</div>
<!-- Right Side -->
<div class="card preview">
<div aria-live="polite" id="qr-holder"></div>
<div class="meta">
<div style="font-size:15px">Size <strong id="previewSize">320</strong>px</div>
<div style="width:100%">
<label for="effect" style="display:block;margin-bottom:6px"><h3 style="margin:0;font-size:1.02rem">QR Style</h3></label>
<select id="effect" style="width:100%;font-size:15px">
<option value="extra-rounded">Extra Rounded</option>
<option value="dots">Dots</option>
<option value="rounded">Rounded</option>
<option value="classy">Classy</option>
<option value="classy-rounded">Classy Rounded</option>
<option value="square">Square</option>
</select>
</div>
</div>
</div>
</main>
<!-- ONE info section BELOW the main area -->
<section aria-live="polite" class="info-section" id="info">
<div aria-label="About" class="info-item" id="about" role="region">
<h2>About</h2>
<p>Welcome to the QR Code Generator. This little tool helps you make clear QR codes fast — no sign-up and no hard settings. You can create a QR from plain text or a link, change size, colors, style, and put a small logo in the middle. It is built to be simple and friendly so anyone can use it.</p>
</div>
<div aria-label="How it Works" class="info-item" id="how" role="region">
<h2>How it Works</h2>
<p>Follow these easy steps:</p>
<ul>
<li><strong>Choose Type:</strong> pick "Plain Text" or "URL".</li>
<li><strong>Paste Content:</strong> put your text or link into the content box.</li>
<li><strong>Customize:</strong> change size, foreground/background color, and the QR style. Optionally add a center logo.</li>
<li><strong>Preview:</strong> the QR updates live on the right so you can check it instantly.</li>
<li><strong>Download:</strong> press "Download PNG" to save the image to your device.</li>
</ul>
</div>
<div aria-label="Articles" class="info-item" id="articles" role="region">
<h2>Articles &amp; Guides</h2>
<article style="margin-bottom:8px">
<h3 style="margin:0 0 6px 0;font-size:1.01rem">What is a QR code?</h3>
<p>QR (Quick Response) codes are two-dimensional barcodes that store text, links or other small pieces of data. They are commonly used to link to websites, share contact information, or trigger actions on a smartphone. Our generator creates high-resolution QR images suitable for print or web use.</p>
</article>
<article>
<h3 style="margin:0 0 6px 0;font-size:1.01rem">Best practices when using QR codes</h3>
<ul>
<li>Ensure contrast: dark foreground, light background for best scanning.</li>
<li>Keep quiet zone: leave margin around the QR so scanners can read it.</li>
<li>Test on devices: scan with multiple phones before publishing.</li>
<li>Avoid excessive decoration: small logos are fine, but do not cover too much of the code.</li>
</ul>
</article>
</div>
<div aria-label="Privacy Policy" class="info-item" id="privacy" role="region">
<h2>Privacy Policy</h2>
<p><strong>Effective date:</strong> 2025-09-19</p>
<p>Short version: This tool runs in your browser. Your text and any image you upload are processed locally on your device and are not sent to a remote server by this page unless you explicitly submit them elsewhere. We do not collect or store your QR content on our servers.</p>
<p><strong>Advertising &amp; third parties:</strong> Our website uses Google AdSense to display ads. Google, as a third-party vendor, may use cookies to serve ads based on your prior visits to this site and other sites on the Internet. Google’s use of advertising cookies enables personalized advertising. Learn more about Google’s advertising practices and your choices here: <a href="https://policies.google.com/technologies/ads" rel="noopener noreferrer" target="_blank">Google Advertising Policies</a>.</p>
<p><strong>Opting out / controlling personalised ads:</strong> You can opt out of personalized advertising from Google by visiting <a href="https://www.google.com/settings/ads" rel="noopener noreferrer" target="_blank">Google Ads Settings</a>.</p>
<p><strong>Cookies:</strong> This site may store small pieces of data (cookies or localStorage) to remember preferences such as cookie consent and theme choices.</p>
<p><strong>Contact:</strong> To request removal or ask privacy questions, email us at <a href="mailto:qr.code.generator.seven.drab@gmail.com">qr.code.generator.seven.drab@gmail.com</a>.</p>
<p><strong>Google AdSense program policies:</strong> We follow Google AdSense Program Policies. For details see: <a href="https://support.google.com/adsense/answer/48182" rel="noopener noreferrer" target="_blank">AdSense Program Policies</a>.</p>
</div>
<div aria-label="Terms" class="info-item" id="terms" role="region">
<h2>Terms of Service</h2>
<p>By using this site you agree to use generated QR codes responsibly. You must not use the service to create content that violates applicable laws or Google AdSense policies if you place ads on pages that host user-generated content.</p>
</div>
<div aria-label="Contact" class="info-item" id="contact" role="region">
<h2>Contact</h2>
<p>Need help, or want some changes on the website? Use the Email below.</p>
<p style="margin:0"><strong>Email:</strong> <a href="https://mail.google.com/mail/?view=cm&amp;fs=1&amp;to=qr.code.generator.seven.drab@gmail.com" rel="noopener noreferrer" target="_blank">qr.code.generator.seven.drab@gmail.com</a></p>
</div>
</section>
<!-- Cookie consent banner -->
<div class="cookie-banner" id="cookieBanner" style="display:flex">
<p>We use cookies and third-party services (like Google) to show ads and improve experience. By continuing you agree to our use of cookies. </p>
<div style="display:flex;gap:8px;align-items:center">
<button class="btn" id="acceptCookies">Accept</button>
<button class="btn" id="manageCookies" style="background:transparent;border:1px solid rgba(0,0,0,0.06);">Manage</button>
</div>
</div>
<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
<script>
  (function(){
    'use strict';

    const $ = (sel) => document.querySelector(sel);

    let sideMenu, menuBtn, infoItems, menuLinks, cookieBanner, acceptBtn, manageBtn;
    let typeEl, contentField, contentEl, fgEl, bgEl, sizeRange, sizeVal, previewSize, downloadPNG, effectEl, logoFile;
    let qrCode = null; let logoDataUrl = null;

    function safeQueryAll(sel) { try { return Array.from(document.querySelectorAll(sel)); } catch(e){ return []; } }

    document.addEventListener('DOMContentLoaded', () => {
      try {
        sideMenu = $('#sideMenu');
        menuBtn = document.querySelector('.menu-btn');
        infoItems = safeQueryAll('.info-item');
        menuLinks = safeQueryAll('.side-menu a');
        cookieBanner = document.getElementById('cookieBanner');
        acceptBtn = document.getElementById('acceptCookies');
        manageBtn = document.getElementById('manageCookies');

        typeEl = document.getElementById('type');
        contentField = document.getElementById('content-field');
        contentEl = document.getElementById('content');
        fgEl = document.getElementById('fg');
        bgEl = document.getElementById('bg');
        sizeRange = document.getElementById('sizeRange');
        sizeVal = document.getElementById('sizeVal');
        previewSize = document.getElementById('previewSize');
        downloadPNG = document.getElementById('downloadPNG');
        effectEl = document.getElementById('effect');
        logoFile = document.getElementById('logo-file');

        bindUI();
        initQR();
        infoItems.forEach(i => i.classList.remove('active'));
        showCookieIfNeeded();
      } catch (err) {
        console.error('Init error', err);
      }
    });

    function bindUI(){
      if (menuBtn && sideMenu) menuBtn.addEventListener('click', toggleMenu);

      if (menuLinks && menuLinks.length){
        menuLinks.forEach(link => {
          link.addEventListener('click', menuLinkClick);
        });
      }

      if (acceptBtn) acceptBtn.addEventListener('click', ()=>{ try{ localStorage.setItem('qr_cookie_consent','accepted'); }catch(e){} cookieBanner.style.display='none'; });
      if (manageBtn) manageBtn.addEventListener('click', ()=>{ const privacyLink = document.querySelector('.side-menu a[href="#privacy"]'); if (privacyLink) privacyLink.click(); });

      if (typeEl) typeEl.addEventListener('change', ()=>{ updateContentField(); createQR(); });
      if (sizeRange) sizeRange.addEventListener('input', ()=>{ sizeVal.textContent = sizeRange.value + 'px'; previewSize.textContent = sizeRange.value; createQR(); });
      [fgEl, bgEl, effectEl].forEach(el => { if (el) el.addEventListener('change', ()=> createQR()); });
      if (downloadPNG) downloadPNG.addEventListener('click', async ()=>{ if(!qrCode) return; try{ const blob = await qrCode.getRawData('png'); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='qr.png'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); }catch(e){console.error(e)} });

      if (logoFile) logoFile.addEventListener('change', logoFileChangeHandler);

      document.addEventListener('click', (e) => {
        if (!sideMenu) return;
        if (!sideMenu.contains(e.target) && !menuBtn.contains(e.target)) {
          sideMenu.classList.remove('show');
          sideMenu.setAttribute('aria-hidden', 'true');
          menuBtn.setAttribute('aria-expanded', 'false');
          document.body.classList.remove('menu-open');
        }
      });

      document.addEventListener('keydown', (ev)=>{
        if (ev.key === 'Escape' && cookieBanner && cookieBanner.style.display === 'flex'){
          cookieBanner.style.display = 'none'; try{ localStorage.setItem('qr_cookie_consent','dismissed'); }catch(e){}
        }
        if (ev.key === 'Escape' && sideMenu && sideMenu.classList.contains('show')){
          sideMenu.classList.remove('show');
          sideMenu.setAttribute('aria-hidden', 'true');
          if (menuBtn) menuBtn.setAttribute('aria-expanded','false');
          document.body.classList.remove('menu-open');
        }
      });
    }

    function menuLinkClick(e){
      e.preventDefault();
      const href = e.currentTarget.getAttribute('href');
      if (!href) return;
      sideMenu.classList.remove('show');
      sideMenu.setAttribute('aria-hidden', 'true');
      menuBtn.setAttribute('aria-expanded', 'false');
      document.body.classList.remove('menu-open');

      if (href === '#home' || href === 'index.html'){
        hideAllPanels();
        document.getElementById('home').scrollIntoView({behavior:'smooth', block:'start'});
        return;
      }

      const targetId = href.replace('#','');
      showPanel(targetId);
      const targetEl = document.getElementById(targetId);
      if (targetEl) {
        setTimeout(() => {
          const topbarHeight = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--topbar-height')) || 64;
          const rect = targetEl.getBoundingClientRect();
          const absoluteTop = rect.top + window.pageYOffset - topbarHeight;
          window.scrollTo({ top: Math.max(0, Math.floor(absoluteTop)), behavior: 'smooth' });
        }, 40);
      }
    }

    function toggleMenu(){
      if (!sideMenu) return;
      const showing = sideMenu.classList.toggle('show');
      sideMenu.setAttribute('aria-hidden', !showing);
      if (menuBtn) menuBtn.setAttribute('aria-expanded', showing);
      // prevent background scroll when menu open (better mobile UX)
      try { document.body.classList.toggle('menu-open', showing); } catch(e){}
    }

    function hideAllPanels(){
      const current = document.querySelector('.info-item.active');
      if (current) current.classList.remove('active');
    }

    function showPanel(id){
      if (!infoItems) return;
      const current = document.querySelector('.info-item.active');
      const target = document.getElementById(id);
      if (!target) return;

      if (current === target) {
        setTimeout(()=>{ const topbarHeight = 64; const rect = target.getBoundingClientRect(); const absoluteTop = rect.top + window.pageYOffset - topbarHeight; window.scrollTo({ top: Math.max(0, Math.floor(absoluteTop)), behavior: 'smooth' }); }, 20);
        return;
      }

      if (current) current.classList.remove('active');
      target.classList.add('active');
    }

    function showCookieIfNeeded(){
      try{
        const seen = localStorage.getItem('qr_cookie_consent');
        if (!seen && cookieBanner) cookieBanner.style.display = 'flex';
      }catch(e){}
    }

    function logoFileChangeHandler(e){
      const f = e.target.files && e.target.files[0];
      if (!f) return;
      if (!f.type || !f.type.startsWith('image/')) { alert('Please choose an image file (jpg, png, jpeg, gif).'); logoFile.value=''; return; }

      const modal = document.createElement('div'); modal.id='cropperModal'; modal.className='show';
      const backdrop = document.createElement('div'); backdrop.className='backdrop'; backdrop.tabIndex=-1;
      const box = document.createElement('div'); box.id='cropperBox'; box.setAttribute('role','dialog'); box.setAttribute('aria-modal','true');
      const img = document.createElement('img'); img.id='cropperImage'; img.alt='Logo to crop'; img.style.maxWidth='100%';
      const btns = document.createElement('div'); btns.className='modal-buttons';
      const cropBtn = document.createElement('button'); cropBtn.id='cropCircle'; cropBtn.className='btn'; cropBtn.type='button'; cropBtn.textContent='Crop as Circle';
      const cancelBtn = document.createElement('button'); cancelBtn.id='cropCancel'; cancelBtn.className='btn'; cancelBtn.type='button'; cancelBtn.textContent='Cancel';
      btns.appendChild(cropBtn); btns.appendChild(cancelBtn);
      box.appendChild(img); box.appendChild(btns); modal.appendChild(backdrop); modal.appendChild(box); document.body.appendChild(modal);

      let cropperInstance = null;
      const reader = new FileReader();
      reader.onload = ()=>{
        img.src = reader.result;
        const initCropper = ()=>{
          try{
            cropperInstance = new Cropper(img, { aspectRatio:1, viewMode:2, autoCropArea:1, background:false, responsive:true, modal:true });
            cropBtn.focus();
          }catch(err){ console.error('Cropper init error', err); alert('Cropper failed to initialize.'); removeModal(); }
        };
        if ('decode' in img) img.decode().then(initCropper).catch(initCropper); else img.onload = initCropper;
      };
      reader.readAsDataURL(f);

      const removeModal = ()=>{
        try{ if (cropperInstance) { cropperInstance.destroy(); cropperInstance = null; } }catch(e){}
        try{ if (modal && modal.parentNode) modal.parentNode.removeChild(modal); }catch(e){}
        logoFile.value=''; createQR();
      };

      backdrop.addEventListener('click', removeModal);
      cancelBtn.addEventListener('click', removeModal);
      cropBtn.addEventListener('click', ()=>{
        try{
          if (!cropperInstance) return;
          const canvas = cropperInstance.getCroppedCanvas({ width:800, height:800, imageSmoothingEnabled:true, imageSmoothingQuality:'high' });
          const size = Math.min(canvas.width, canvas.height);
          const circleCanvas = document.createElement('canvas'); circleCanvas.width = size; circleCanvas.height = size;
          const ctx = circleCanvas.getContext('2d'); ctx.beginPath(); ctx.arc(size/2, size/2, size/2, 0, 2*Math.PI); ctx.closePath(); ctx.clip(); ctx.drawImage(canvas,0,0,size,size);
          logoDataUrl = circleCanvas.toDataURL('image/png');
        }catch(err){ console.error('Crop error', err); alert('Failed to crop image.'); logoDataUrl = null; }
        removeModal();
      });
    }

    function updateContentField(){
      if (!contentField) return;
      contentField.innerHTML = '<label>Content</label>' + (typeEl && typeEl.value=== 'url' ? '<textarea id="content" placeholder="Paste your URL..."></textarea>' : '<textarea id="content" placeholder="Paste your text..."></textarea>');
      contentEl = document.getElementById('content');
      if (contentEl) contentEl.addEventListener('input', ()=>createQR());
    }

    function initQR(){ updateContentField(); createQR(); }

    function createQR(){
      if (!contentField) return;
      if (!contentEl) updateContentField();
      const data = (contentEl && contentEl.value) ? contentEl.value.trim() : '';
      const size = parseInt(sizeRange ? sizeRange.value : 320, 10) || 320;
      const holder = document.getElementById('qr-holder'); if (!holder) return;
      holder.innerHTML = '';

      const frame = document.createElement('div'); frame.className = 'qr-frame';
      const inner = document.createElement('div'); inner.className = 'qr-inner'; inner.style.width = size + 'px'; inner.style.height = size + 'px';
      frame.appendChild(inner); holder.appendChild(frame);

      if (!data){
        const placeholder = document.createElement('div'); placeholder.style.width='100%'; placeholder.style.height='100%'; placeholder.style.display='flex'; placeholder.style.alignItems='center'; placeholder.style.justifyContent='center'; placeholder.style.background='rgba(255,255,255,0.04)'; placeholder.style.border='2px dashed rgba(0,0,0,0.15)'; placeholder.style.borderRadius='8px'; placeholder.style.color='#000'; placeholder.style.fontSize='14px'; placeholder.style.textAlign='center'; placeholder.textContent = 'Your QR code will appear here'; inner.appendChild(placeholder); if (previewSize) previewSize.textContent = size; if (sizeVal) sizeVal.textContent = size + 'px'; return; }

      const options = { width:size, height:size, data:data, image: logoDataUrl || undefined, dotsOptions:{ color: fgEl ? fgEl.value : '#000', type: effectEl ? effectEl.value : 'rounded' }, backgroundOptions:{ color: bgEl ? bgEl.value : '#fff' }, imageOptions:{ crossOrigin:'anonymous', margin:2, imageSize:0.25, hideBackgroundDots:true, borderRadius:9999 }, qrOptions:{ errorCorrectionLevel:'H' }, margin:4 };
      try{ if (qrCode) { try{ qrCode.clear(); }catch(e){} } qrCode = new QRCodeStyling(options); qrCode.append(inner); }catch(e){console.error('QR init error', e); }
      if (previewSize) previewSize.textContent = size; if (sizeVal) sizeVal.textContent = size + 'px';
    }

  })();
  </script>
</body>
</html>
