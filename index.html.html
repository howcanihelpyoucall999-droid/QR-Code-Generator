<!doctype html>
<html lang="en">
<head>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7183827699743444"
     crossorigin="anonymous"></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QR Code Generator</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet"/>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet"/>

  <style>
    :root{
      --glass: rgba(255,255,255,0.06);
      --accent: #7b61ff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;min-height:100vh;font-family:'Poppins',system-ui,Segoe UI,Roboto,Arial;
      background: linear-gradient(120deg,#FF8A00 0%, #FF3D81 30%, #7B61FF 60%, #00D2FF 100%);
      display:flex;align-items:center;justify-content:center;padding:20px;color:#000;
      overflow:hidden;
    }

    .container{position:relative;z-index:2;display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:center;max-width:1000px;width:100%;height:90vh}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02));backdrop-filter:blur(6px);border-radius:18px;padding:20px;box-shadow:0 10px 30px rgba(0,0,0,0.25);overflow:hidden;height:100%}

    .left h1{margin:0 0 8px 0;font-size:24px;color:#000;text-shadow:0 0 6px rgba(0,0,0,0.3)}
    .left p{margin:0 0 12px 0;opacity:0.9;font-size:14px;color:#000;text-shadow:0 0 6px rgba(0,0,0,0.3)}

    .controls{display:grid;gap:10px;margin-bottom:10px}
    .field{background:var(--glass);padding:10px;border-radius:12px}
    label{display:block;font-size:12px;margin-bottom:6px;opacity:0.9;color:#000;text-shadow:0 0 6px rgba(0,0,0,0.3)}

    input[type=text], select, textarea{
      width:100%;padding:8px;border-radius:8px;border:0;
      background:rgba(255,255,255,0.15);color:#000;font-size:13px;outline:none;
      transition:all 0.3s ease;text-shadow:0 0 6px rgba(0,0,0,0.2)
    }
    textarea{min-height:60px;resize:none}
    .row{display:flex;gap:10px}

    .preview{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;border-radius:16px;background:linear-gradient(135deg, rgba(255,255,255,0.03), rgba(0,0,0,0.02))}
    #qr-holder{width:320px;height:320px;display:flex;align-items:center;justify-content:center}
    .meta{margin-top:12px;display:flex;flex-direction:column;gap:10px;align-items:center;font-size:13px;color:#000;text-shadow:0 0 6px rgba(0,0,0,0.3)}
    .btn{
      background:linear-gradient(90deg,#ff8a00,#ff3d81,#7b61ff,#00d2ff);
      border:0;padding:10px 16px;border-radius:12px;
      color:#000;font-weight:600;cursor:pointer;font-size:13px;
      transition:0.3s;text-shadow:0 0 6px rgba(0,0,0,0.3)
    }
    .btn:hover{opacity:0.85}
    .btn:active{animation:pulse 0.3s ease}

    .color-input{height:28px;width:40px;border-radius:6px;border:0;padding:0;transition:all 0.3s ease}
    .range{display:flex;align-items:center;gap:8px}
    input[type=range]{width:100%;transition:all 0.3s ease}

    select:hover, input[type=color]:hover, input[type=range]:hover, textarea:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(0,0,0,0.4);
    }
    input[type=range]::-webkit-slider-thumb {transition: all 0.3s ease;}
    input[type=range]:active::-webkit-slider-thumb {
      transform: scale(1.2);
      box-shadow: 0 0 10px #000;
    }
    input[type=color]:active {transform: rotate(10deg) scale(1.1);}
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(0.9); }
      100% { transform: scale(1); }
    }
 
@media (max-width:900px){
  body{
    display:block;
    overflow:auto;
  }
  .container{
    grid-template-columns:1fr;
    grid-template-rows:auto auto;
    gap:14px;
    height:auto;     
  }
  .card{
    height:auto;     
  }
  .preview{order:-1}        
  .left h1, .left p { display:none; }       
  .preview .mobile-title { display:block; }
}


    

    /* Cropper modal */
    #cropperModal {
      position: fixed; top:0; left:0; width:100%; height:100%;
      background: linear-gradient(120deg,#FF8A00 0%, #FF3D81 30%, #7B61FF 60%, #00D2FF 100%);
      display:none; align-items:center; justify-content:center; z-index:9999;
      flex-direction:column;
    }
    #cropperBox {
      background:#fff; padding:10px; border-radius:10px; max-width:90%; max-height:90%;
      display:flex; flex-direction:column; align-items:center;
    }
    #cropperImage {max-width:100%; max-height:65vh;}
    .modal-buttons {margin-top:10px; display:flex; gap:10px; justify-content:center;}
  </style>
</head>
<body>
  <div class="container">
    <!-- Left Side -->
    <div class="card left">
      <h1>QR Code Generator</h1>
      <p></p>

      <div class="controls">
        <div class="field">
          <label for="type"><h3>Type</h3></label>
          <select id="type">
            <option value="text">Plain Text</option>
            <option value="url">URL</option>
          </select>
        </div>
      </div>

      <div class="field" id="content-field">
        <label id="content-label"></label>
        <textarea id="content" placeholder="Paste your text..."></textarea>
      </div>

      <div class="row">
        <div style="flex:1" class="field">
          <label><h3>Logo / Center Image (optional)</h3></label>
          <input id="logo-file" type="file" accept="image/*" />
        </div>
        <div style="width:200px" class="field">
          <label>Size (Max 320px)</label>
          <div class="range">
            <input id="sizeRange" type="range" min="128" max="320" value="320">
            <div style="width:50px;text-align:right" id="sizeVal">320px</div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="field" style="flex:1">
          <label>Foreground Color</label>
          <input id="fg" class="color-input" type="color" value="#000000">
        </div>
        <div class="field" style="flex:1">
          <label>Background Color</label>
          <input id="bg" class="color-input" type="color" value="#ffffff">
        </div>
      </div>

      <div style="margin-top:12px">
        <button id="downloadPNG" class="btn">Download PNG</button>
      </div>
    </div>

    <!-- Right Side -->
    <div class="card preview">
      <div id="qr-holder"></div>
      <div class="meta">
        <div>Size <strong id="previewSize">320</strong>px</div>
        <div>
          <label for="effect"><h3>QR Style</h3></label>
          <select id="effect">
            <option value="dots">Dots</option>
            <option value="rounded">Rounded</option>
            <option value="classy">Classy</option>
            <option value="classy-rounded">Classy Rounded</option>
            <option value="square">Square</option>
            <option value="extra-rounded">Extra Rounded</option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Cropper Modal -->
  <div id="cropperModal">
    <div id="cropperBox">
      <img id="cropperImage" />
      <div class="modal-buttons">
        <button id="cropCircle" class="btn">Crop as Circle</button>
        <button id="cropCancel" class="btn">Cancel</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
  <script>
    const typeEl=document.getElementById('type');
    const contentField=document.getElementById('content-field');
    let contentEl=document.getElementById('content');
    const fgEl=document.getElementById('fg');
    const bgEl=document.getElementById('bg');
    const sizeRange=document.getElementById('sizeRange');
    const sizeVal=document.getElementById('sizeVal');
    const previewSize=document.getElementById('previewSize');
    const downloadPNG=document.getElementById('downloadPNG');
    const logoFile=document.getElementById('logo-file');
    const effectEl=document.getElementById('effect');
    let logoDataUrl=null;
    let qrCode=null;
    let cropper=null;

    const cropperModal=document.getElementById('cropperModal');
    const cropperImage=document.getElementById('cropperImage');
    const cropCircle=document.getElementById('cropCircle');
    const cropCancel=document.getElementById('cropCancel');

    function updateContentField(){
      contentField.innerHTML = '<label>Content</label>' + 
        (typeEl.value==="url" ? '<textarea id="content" placeholder="Paste your URL..."></textarea>' : '<textarea id="content" placeholder="Paste your text..."></textarea>');
      contentEl=document.getElementById('content');
      contentEl.addEventListener('input',()=>createQR());
    }

    function createQR(){
      const data = contentEl.value.trim();
      const size = parseInt(sizeRange.value, 10);
      const holder = document.getElementById('qr-holder');
      holder.innerHTML = '';

      if(!data){
        const placeholder = document.createElement('div');
        placeholder.style.width = size + 'px';
        placeholder.style.height = size + 'px';
        placeholder.style.display = 'flex';
        placeholder.style.alignItems = 'center';
        placeholder.style.justifyContent = 'center';
        placeholder.style.background = 'rgba(255,255,255,0.1)';
        placeholder.style.border = '2px dashed rgba(0,0,0,0.3)';
        placeholder.style.borderRadius = '16px';
        placeholder.style.color = '#000';
        placeholder.style.fontSize = '16px';
        placeholder.style.textAlign = 'center';
        placeholder.textContent = 'Your QR code will appear here';
        holder.appendChild(placeholder);
        previewSize.textContent = size;
        sizeVal.textContent = size + 'px';
        return;
      }

      const options = {
        width: size,
        height: size,
        data: data,
        image: logoDataUrl || undefined,
        dotsOptions: { color: fgEl.value, type: effectEl.value },
        backgroundOptions: { color: bgEl.value },
        imageOptions: {
          crossOrigin: 'anonymous',
          margin: 2,
          imageSize: 0.25,
          hideBackgroundDots: true,
          borderRadius: 9999
        },
        qrOptions: { errorCorrectionLevel: "H" },
        margin: 4
      };

      if(qrCode){ try { qrCode.clear(); } catch(e){} }
      qrCode = new QRCodeStyling(options);
      qrCode.append(holder);

      previewSize.textContent = size;
      sizeVal.textContent = size + 'px';
    }

    updateContentField();
    createQR();

    typeEl.addEventListener('change',()=>{updateContentField();createQR();});
    sizeRange.addEventListener('input',()=>{sizeVal.textContent=sizeRange.value+'px';previewSize.textContent=sizeRange.value;createQR();});
    [fgEl,bgEl,effectEl].forEach(el=>el.addEventListener('change',()=>createQR()));

    // File upload with proper cropper reset
    logoFile.addEventListener('change', e => {
      const f = e.target.files[0]; 
      if(!f) return;

      // Reset previous cropper if exists
      if(cropper){ cropper.destroy(); cropper=null; }
      cropperImage.src = '';
      logoDataUrl = null;

      const r = new FileReader();
      r.onload = () => {
        cropperImage.src = r.result;
        cropperModal.style.display = "flex";
        cropper = new Cropper(cropperImage, { aspectRatio: 1, viewMode: 1 });
      };
      r.readAsDataURL(f);
    });

    function applyCircleCrop(){
      if(cropper){
        const canvas=cropper.getCroppedCanvas({width:200,height:200});
        const size=Math.min(canvas.width,canvas.height);
        const circleCanvas=document.createElement('canvas');
        circleCanvas.width=size;
        circleCanvas.height=size;
        const ctx=circleCanvas.getContext('2d');
        ctx.beginPath();
        ctx.arc(size/2,size/2,size/2,0,2*Math.PI);
        ctx.closePath();
        ctx.clip();
        ctx.drawImage(canvas,0,0,size,size);
        logoDataUrl=circleCanvas.toDataURL("image/png");
        cropper.destroy();
        cropper=null;
        cropperModal.style.display="none";
        logoFile.value = ''; // reset input so user can select again
        createQR();
      }
    }

    cropCircle.addEventListener('click', applyCircleCrop);
    cropCancel.addEventListener('click', ()=>{
      if(cropper){cropper.destroy(); cropper=null;}
      cropperModal.style.display="none";
      logoDataUrl = null; // cancel resets logo
      logoFile.value = ''; // allow re-selecting
      createQR();
    });

    downloadPNG.addEventListener('click', async ()=>{
      if(!qrCode) return;
      const blob = await qrCode.getRawData('png');
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download='qr.png';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>

